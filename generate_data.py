# ===========================================================================
# Notes
# ===========================================================================
"""
(*) This script generates the data by calling the StochasticPro class
"""
# ===========================================================================
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# ===========================================================================
# Imports
# ===========================================================================
# import numpy as np
from Models.StochasticPro import StochasticPro
from Utils.DBConnection import DBConnection
# ===========================================================================
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# ===========================================================================
# Set parameters
# ===========================================================================

# ===========================================================================
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# ===========================================================================
# Load the data
# ===========================================================================
# Initialize the connection to the database
conn = DBConnection()
conn.create_booking_table()

# Initialize the stochastic process class
ins = StochasticPro()
ins.initialize_room_dict()
ins.add_reservation_periods()
# ===========================================================================
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# ===========================================================================
# Append the data into the database
# ===========================================================================
for k in ins.room_process.keys():
    for i in range(len(ins.room_process[k])):
        room_dict = ins.room_process[k][i]
        if room_dict['used'] == 1:
            conn.insert_into_booking(room_dict=room_dict, room_id=k)
# ===========================================================================
